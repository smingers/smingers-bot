# Metaculus AI Forecasting Bot Configuration
# 5-Agent Ensemble Pipeline

# =============================================================================
# RUN MODE
# =============================================================================
# Controls model selection and submission behavior:
#   - "test": Cheap models (Haiku), no submission - for testing pipeline
#   - "preview": Production models, no submission - for evaluating quality
#   - "live": Production models, submits to Metaculus
#
# Override with --mode flag: python main.py --question 12345 --mode live

mode: "test"

# =============================================================================
# MODEL CONFIGURATION
# =============================================================================
# Models used for research query generation and other utility tasks.
# All models accessed via OpenRouter (set OPENROUTER_API_KEY).
#
# The 5-agent ensemble is configured separately below.

models:
  # Models for test mode (cheap, fast)
  cheap:
    query_generator: "openrouter/anthropic/claude-3.5-haiku"
    article_summarizer: "openrouter/anthropic/claude-3.5-haiku"
    agentic_search: "openrouter/anthropic/claude-3.5-haiku"

  # Models for preview and live modes
  production:
    query_generator: "openrouter/openai/o3"
    article_summarizer: "openrouter/anthropic/claude-sonnet-4.5"
    agentic_search: "openrouter/openai/o3"

# =============================================================================
# 5-AGENT ENSEMBLE CONFIGURATION
# =============================================================================
# The ensemble uses 5 forecasting agents with configurable weights and model 
# selection
#
# Cross-pollination structure (creates cross-model diversity):
#   - Agent 1 (Sonnet 4.5) receives Agent 1's step 1 output (Sonnet 4.5)
#   - Agent 2 (Sonnet 4.5) receives Agent 4's step 1 output (o3)
#   - Agent 3 (GPT-5.2) receives Agent 2's step 1 output (Sonnet 4.5)
#   - Agent 4 (o3) receives Agent 3's step 1 output (GPT-5.2)
#   - Agent 5 (o3) receives Agent 5's step 1 output (o3)

ensemble:
  # Agents for test mode (all Haiku - cheap, fast)
  cheap:
    - name: "forecaster_1"
      model: "openrouter/anthropic/claude-3.5-haiku"
      weight: 1.0

    - name: "forecaster_2"
      model: "openrouter/anthropic/claude-3.5-haiku"
      weight: 1.0

    - name: "forecaster_3"
      model: "openrouter/anthropic/claude-3.5-haiku"
      weight: 1.0

    - name: "forecaster_4"
      model: "openrouter/anthropic/claude-3.5-haiku"
      weight: 1.0

    - name: "forecaster_5"
      model: "openrouter/anthropic/claude-3.5-haiku"
      weight: 1.0

  # Agents for preview and live modes
  production:
    - name: "forecaster_1"
      model: "openrouter/anthropic/claude-sonnet-4.5"
      weight: 1.0

    - name: "forecaster_2"
      model: "openrouter/anthropic/claude-sonnet-4.5"
      weight: 1.0

    - name: "forecaster_3"
      model: "openrouter/openai/gpt-5.2"
      weight: 1.0

    - name: "forecaster_4"
      model: "openrouter/openai/o3"
      weight: 1.0

    - name: "forecaster_5"
      model: "openrouter/openai/o3"
      weight: 1.0

  aggregation: "weighted_average"

# =============================================================================
# RESEARCH CONFIGURATION
# =============================================================================
# Research is integrated into each handler. The pipeline:
# 1. Generate historical queries (outside view context)
# 2. Generate current queries (inside view context)
# 3. Execute searches via Google (Serper) and AskNews
# 4. Extract and summarize content

research:
  # Google search via Serper API
  google_enabled: true
  google_max_results: 10

  # AskNews integration
  asknews_enabled: true
  asknews_max_results: 10
  asknews_hours_back: 72

  # Agentic search (iterative LLM-guided research)
  agentic_search_enabled: true
  agentic_search_max_steps: 7

  # Article scraping
  scraping_enabled: true
  max_articles_to_scrape: 10
  max_content_length: 15000

  # Research validation (detects and resolves factual conflicts)
  # When enabled, an agent reviews research for mutually exclusive claims
  # and attempts to resolve them through targeted verification searches
  validation_enabled: false  # Set to true to enable
  validation_model: "openrouter/anthropic/claude-sonnet-4.5"

  # Legacy settings (for backward compatibility)
  sources:
    - type: "llm_knowledge"
      enabled: true

    - type: "asknews"
      enabled: true
      cache_mode: "no_cache"

    - type: "asknews_wiki"
      enabled: true
      max_results: 5

    - type: "article_scraping"
      enabled: true
      max_articles: 5
      max_content_length: 5000

# =============================================================================
# SUBMISSION CONFIGURATION
# =============================================================================
submission:
  store_reasoning: true
  tournament_id: null

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================
storage:
  base_dir: "./data"
  database_path: "./data/forecasts.db"
  snapshot_configs: true

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
logging:
  level: "INFO"
  log_llm_calls: true
  track_costs: true